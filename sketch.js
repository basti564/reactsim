var tempSlider,foreSlider,backSlider,rInput,yInput,gInput,bInput,eInput,sel,selColor,startButton,fA,bA,rType,balls=[],types=[],ballNum=0,hist=[],numPts=0,colors=[];function getSum(e,t){return e+t}function setup(){createCanvas(0,0),div=createDiv(),createP("Foreward Reaction").parent(div),(foreSlider=createSlider(10,50,null==getItem("foreSlider")?30:getItem("foreSlider")).parent(div)).input(store),(rInput=createInput(null==getItem("types")?10:getItem("types")[0],"number").attribute("placeholder","RED").attribute("min","0").attribute("style","color:#ff0000").parent(div)).input(store),(yInput=createInput(null==getItem("types")?"":getItem("types")[1],"number").attribute("placeholder","YELLOW").attribute("min","0").attribute("style","color:#ffff00").parent(div)).input(store),createP("Backward Reaction").parent(div),(backSlider=createSlider(10,50,null==getItem("backSlider")?30:getItem("backSlider")).parent(div)).input(store),(gInput=createInput(null==getItem("types")?"":getItem("types")[2],"number").attribute("placeholder","GREEN").attribute("min","0").attribute("style","color:#00ff00").parent(div)).input(store),(bInput=createInput(null==getItem("types")?"":getItem("types")[3],"number").attribute("placeholder","BLUE").attribute("min","0").attribute("style","color:#0000ff").parent(div)).input(store),createP("Reaction Type").parent(div),(sel=createSelect().parent(div)).option("Red+Yellow <-> Blue+Green"),sel.option("Red+Yellow <-> 2Blue"),sel.option("Red+Yellow <-> Blue+Green | Red+Black -> 'gone'"),sel.input(store),null!=getItem("sel")&&sel.selected(getItem("sel")),createP("Temperature").parent(div),(tempSlider=createSlider(10,30,null==getItem("tempSlider")?20:getItem("tempSlider")).parent(div)).input(store),createP("Color Types").parent(div),(selColor=createSelect().parent(div)).option("Normal Colors"),selColor.option("Safe Colors"),selColor.input(store),null!=getItem("selColor")&&selColor.selected(getItem("selColor")),(startButton=createButton("Start").parent(div)).mousePressed(start)}function store(){storeItem("tempSlider",tempSlider.value()),storeItem("foreSlider",foreSlider.value()),storeItem("backSlider",backSlider.value()),storeItem("sel",sel.selected()),storeItem("selColor",selColor.selected()),storeItem("types",[rInput.value(),yInput.value(),gInput.value(),bInput.value()])}function start(){resizeCanvas(483,634),document.body.scrollTop=0,document.documentElement.scrollTop=0,store(),fA=.1*foreSlider.value(),bA=.1*backSlider.value(),rType=sel.value(),colors="NORMAL COLORS"==selColor.value()?[color(255,255,255),color(255,0,0),color(255,255,0),color(0,255,0),color(0,0,255),color(0,0,0)]:[color(255,255,255),color(255,0,0),color(255,255,0),color(255,0,255),color(0,0,255),color(0,0,0)],hist=new Array(1e3).fill([]),balls=[],(types=getItem("types")).forEach((e,t)=>{e=int(e),isNaN(e)&&(e=0),types[t]=e}),ballNum=types.reduce(getSum),"Red+Yellow <-> Blue+Green | Red+Black -> 'gone'"==sel.selected()&&(blackNum=Math.floor(1.5*ballNum),types.push(blackNum),ballNum=blackNum),r=53/sqrt(ballNum)*sqrt(width*height/2)/sqrt(153111),i=0,types.forEach((e,l)=>{for(t=i;i<e+t;i++){var o,a=!1;do{a=!1,position=new p5.Vector(random(width),random(height/2)),o=new Ball(position,r,tempSlider.value()/10,pow(2,l));for(var s=0;s<i;s++)o.checkCollision(balls[s])&&(a=!0)}while(a);balls[i]=o}})}function draw(){background(50);for(var e=0;e<balls.length;e++){var t=balls[e];if(0!=t.type){t.display(),16!=t.type&&0!=t.type&&t.update(),t.checkBoundaryCollision();for(var l=0;l<balls.length;l++)if(e!=l){if(0==balls[l].type||16==balls[l].type)continue;t.checkCollision(balls[l])&&(t.react(balls[l]),t.collide(balls[l]))}}}var r=new Array(6).fill(0);for(e=0;e<balls.length;e++)hI=log(0==balls[e].type?1:2*balls[e].type)/log(2),r[hI]=r[hI]+1;hist.push(r),hist.shift(),translate(0,height),strokeWeight(1),colors.forEach((e,t)=>{0!=t&&(tV=[],hist.forEach(e=>{tV.push(e[t])}),drawLines(tV,e))})}function drawLines(e,t){numPts=e.length,stroke(t);let l=0,r=-e[0]/ballNum*height/2;for(let t=0;t<e.length;t++){let o=t*(width/(numPts-1)),a=-e[t]/ballNum*height/2;line(l,r,o,a),l=o,r=a}}
